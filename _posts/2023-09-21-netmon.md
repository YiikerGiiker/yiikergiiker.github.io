---
layout: post
title: "HTB Windows Easy: Netmon"
description: "Netmon is an Easy rated Windows machine on HTB."
categories: [CTF,HTB]
tags: [Windows,Easy]
author: g
---

### Nmap Scan
![Pasted image 20240714200748.png](/images/Pasted image 20240714200748.png){: .normal }

## _**Initial Foothold**_
### Enumerating FTP (port 21)
Anonymous login is allowed on the FTP server.
![Pasted image 20240714200741.png](/images/Pasted image 20240714200741.png){: .normal width="600" }


From the Nmap scan we also know that prtg network monitor is running on the system, we could find configuration files regarding this service to get a password, after googling around and testing a bit on the ftp server I ended up finding the following directory.
![Pasted image 20240714200737.png](/images/Pasted image 20240714200737.png){: .normal width="600" }


In this directory we find a backup config file: `PRTG Configuration.old.bak`.
![Pasted image 20240714200729.png](/images/Pasted image 20240714200729.png){: .normal width="600" }


Looking through the file we find a username and password that we can use to log in: `prtgadmin:PrTg@dmin2018`.
![Pasted image 20240714200723.png](/images/Pasted image 20240714200723.png){: .normal width="400" }


These credentials however didn't work, I ended up checking the release date of the machine and tried to update the password to the year it was released (which worked): `prtgadmin:PrTg@dmin2019`.
![Pasted image 20240714200718.png](/images/Pasted image 20240714200718.png){: .normal }



### Exploiting HTTP (Port 80)
The version of PRTG that is being used is vulnerable to RCE, we can use a Metasploit module to gain shell access.
![Pasted image 20240714200713.png](/images/Pasted image 20240714200713.png){: .normal }


Set options.
![Pasted image 20240714200708.png](/images/Pasted image 20240714200708.png){: .normal }


Exploit.
![Pasted image 20240714200705.png](/images/Pasted image 20240714200705.png){: .normal }


## User.txt
![Pasted image 20240714200701.png](/images/Pasted image 20240714200701.png){: .normal width="400" }


## Root.txt
![Pasted image 20240714200657.png](/images/Pasted image 20240714200657.png){: .normal }


## You have PWNED!!!
![Pasted image 20240714200651.png](/images/Pasted image 20240714200651.png){: .normal }


### Sources
- [PRTG config directory](https://www.reddit.com/r/sysadmin/comments/835dai/prtg_exposes_domain_accounts_and_passwords_in/)
- [PRTG config directory 2](https://kb.paessler.com/en/topic/463-how-and-where-does-prtg-store-its-data)