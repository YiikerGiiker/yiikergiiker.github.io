---
layout: post
title: "Shocker"
description: "Shocker is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715103728.png](/images/Pasted image 20240715103728.png){: .normal }

## _**Initial Foothold**_
### HTTP
Use dirb for directory busting to find the cgi-bin endpoint.
![Pasted image 20240715103712.png](/images/Pasted image 20240715103712.png){: .normal width="500" }


Enumerating the cgi-bin directory using ffuf, no scripts were found with the .cgi extension, however the .sh extension returned a result: `user.sh`.
![Pasted image 20240715103705.png](/images/Pasted image 20240715103705.png){: .normal width="600" }

Since we know what script is in the /cgi-bin/ directory we can use it to get a reverse shell. For this we will use burpsuite and change our User-Agent to a reverse shell.
![Pasted image 20240715103700.png](/images/Pasted image 20240715103700.png){: .normal }

Our nc listener should have turned into a shell.
![Pasted image 20240715103655.png](/images/Pasted image 20240715103655.png){: .normal width="500" }


## _**Priv Esc**_
Sudo -l reveals a binary that we can execute with sudo, use GTFObins to escalate to root.
![Pasted image 20240715103646.png](/images/Pasted image 20240715103646.png){: .normal }


## User.txt
![Pasted image 20240715103638.png](/images/Pasted image 20240715103638.png){: .normal width="500" }


## Root.txt
![Pasted image 20240715103632.png](/images/Pasted image 20240715103632.png){: .normal width="400" }


## PWNED!!!
![Pasted image 20240715103627.png](/images/Pasted image 20240715103627.png){: .normal }


### Sources
- [What is cgi-bin](https://www.hostgator.com/help/article/what-is-cgi-bin)
- [Shellshock](https://exploit-notes.hdks.org/exploit/web/cgi-pentesting/)
- [Perl priv-esc](https://gtfobins.github.io/gtfobins/perl/#sudo)