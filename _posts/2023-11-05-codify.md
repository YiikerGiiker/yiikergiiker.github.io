---
layout: post
title: "HTB Linux Easy: Codify"
description: "Codify is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715101620.png](/images/Pasted image 20240715101620.png){: .normal }

## _**Initial Foothold**_
The website redirects to `codify.htb`, add this domain to the hosts file:
![Pasted image 20240715101615.png](/images/Pasted image 20240715101615.png){: .normal width="400" }


### Enumerating HTTP (Port 80)
The about page mentions the usage of the vm2 library which is vulnerable to RCE.
![Pasted image 20240715101608.png](/images/Pasted image 20240715101608.png){: .normal }


### Gain shell
Gain a reverse shell from the PoC RCE payload.
![Pasted image 20240715101602.png](/images/Pasted image 20240715101602.png){: .normal }


Shell as the svc user:
![Pasted image 20240715101558.png](/images/Pasted image 20240715101558.png){: .normal }


## _**Lateral movement**_
In `/var/www/contact` we find a `tickets.db` file with a username and password hash.
![Pasted image 20240715101554.png](/images/Pasted image 20240715101554.png){: .normal }

This password can be cracked using JohnTheRipper.
![Pasted image 20240715101550.png](/images/Pasted image 20240715101550.png){: .normal }

Become the Joshua user `joshua:spongebob1`.
![Pasted image 20240715101546.png](/images/Pasted image 20240715101546.png){: .normal }


## _**Priv Esc**_
Sudo -l output.
![Pasted image 20240715101542.png](/images/Pasted image 20240715101542.png){: .normal }

Script accepts wildcards (input \*).
![Pasted image 20240715101537.png](/images/Pasted image 20240715101537.png){: .normal }

Create a Python script to bruteforce the password login using the wildcard.
![Pasted image 20240715101531.png](/images/Pasted image 20240715101531.png){: .normal }

The script should output the password: `kljh12k3jhaskjh12kjh3`
![Pasted image 20240715101527.png](/images/Pasted image 20240715101527.png){: .normal width="400" }

Change to root using the retrieved password.
![Pasted image 20240715101521.png](/images/Pasted image 20240715101521.png){: .normal width="500" }


## User.txt
![Pasted image 20240715101518.png](/images/Pasted image 20240715101518.png){: .normal width="400" }

## Root.txt
![Pasted image 20240715101513.png](/images/Pasted image 20240715101513.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715101509.png](/images/Pasted image 20240715101509.png){: .normal }


### Sources
- [VM2 RCE PoC](https://security.snyk.io/vuln/SNYK-JS-VM2-5537100)