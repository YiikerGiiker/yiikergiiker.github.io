---
layout: post
title: "HTB Windows Easy: Return"
description: "Return is an Easy rated Windows machine on HTB."
categories: [CTF,HTB]
tags: [Windows,Easy]
author: g
---

## Nmap
![Pasted image 20240714201013.png](/images/Pasted image 20240714201013.png){: .normal }

## _**Initial Foothold**_
### Enumerating HTTP (Port 80)
Browsing to the webpage and going over to the settings tab we see some interesting information like username and password.
![Pasted image 20240714201008.png](/images/Pasted image 20240714201008.png){: .normal }


Since we can’t see the password we’ll have to send it to our computer using a request, for this we can change the server address to our VPN IP and set up a NC listener on port 389 to get the request from the server.
![Pasted image 20240714201003.png](/images/Pasted image 20240714201003.png){: .normal }


When we press update we should see the password in plaintext in our NC listener: `svc-printer:1edFg43012!!`.
![Pasted image 20240714200959.png](/images/Pasted image 20240714200959.png){: .normal width="600" }


### Shell
To get a shell we can simply use the credentials and evil-winrm.
![Pasted image 20240714200953.png](/images/Pasted image 20240714200953.png){: .normal }



## _**Priv Esc**_
Since we are part of the Server Operators group we can escalate our privileges.
![Pasted image 20240714200948.png](/images/Pasted image 20240714200948.png){: .normal width="600" }


Follow guide in sources to priv esc.
![Pasted image 20240714200942.png](/images/Pasted image 20240714200942.png){: .normal }


Your nc listener should've turned into a shell.
![Pasted image 20240714200938.png](/images/Pasted image 20240714200938.png){: .normal width="600" }



## User.txt
![Pasted image 20240714200924.png](/images/Pasted image 20240714200924.png){: .normal width="500" }


## Root.txt
![Pasted image 20240714200920.png](/images/Pasted image 20240714200920.png){: .normal width="600" }

## You have PWNED!!!
![Pasted image 20240714200916.png](/images/Pasted image 20240714200916.png){: .normal }


### Sources
- [Priv-Esc](https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/)