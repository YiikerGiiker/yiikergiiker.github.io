---
layout: post
title: "Bashed"
description: "Bashed is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

### Nmap scan

![Pasted image 20240715102834.png](/images/Pasted image 20240715102834.png){: .normal }

## _**Initial Foothold**_

### Enumerate http (port 80)
Perform directory busting using Dirsearch.
![Pasted image 20240715102828.png](/images/Pasted image 20240715102828.png){: .normal }


In the /dev endpoint we find the `phpbash.php` script.
![Pasted image 20240715102823.png](/images/Pasted image 20240715102823.png){: .normal width="450" }


Use the following Python reverse shell payload to get a reverse shell.
![Pasted image 20240715102819.png](/images/Pasted image 20240715102819.png){: .normal }


Your nc listener should have turned into a shell.
![Pasted image 20240715102815.png](/images/Pasted image 20240715102815.png){: .normal width="550" }



## _**Lateral movement**_
Sudo -l reveals an easy way to escalate to the scriptmanager user:
![Pasted image 20240715102810.png](/images/Pasted image 20240715102810.png){: .normal }



## _**Priv Esc**_
Checking for files owned by the scriptmanager user, we find the `test.py` script:
![Pasted image 20240715102806.png](/images/Pasted image 20240715102806.png){: .normal }


Checking for the permissions of the files we notice that the test.txt file is owned by root
![Pasted image 20240715102802.png](/images/Pasted image 20240715102802.png){: .normal }


Looking at the content of the `test.py` file we see that it writes to the test.txt file. This means that the `test.py` script is being ran by root in a cron job every minute.
![Pasted image 20240715102753.png](/images/Pasted image 20240715102753.png){: .normal width="500" }


To get a root shell we can change the content of the `test.py` file to a Python reverse shell.
![Pasted image 20240715102749.png](/images/Pasted image 20240715102749.png){: .normal width="600" }


After waiting for around a minute our nc listener should've turned into a shell.
![Pasted image 20240715102746.png](/images/Pasted image 20240715102746.png){: .normal }



## User.txt
![Pasted image 20240715102742.png](/images/Pasted image 20240715102742.png){: .normal width="600" }


## Root.txt
![Pasted image 20240715102737.png](/images/Pasted image 20240715102737.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715102732.png](/images/Pasted image 20240715102732.png){: .normal }


### Sources
- [Reverse Shells](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#bash-tcp)