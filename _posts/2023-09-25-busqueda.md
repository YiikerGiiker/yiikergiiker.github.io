---
layout: post
title: "Busqueda"
description: "Busqueda is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715103333.png](/images/Pasted image 20240715103333.png){: .normal }

## _**Initial Foothold**_

### Enumerating HTTP (Port 80)
Add the `searcher.htb` domain to the hosts file to resolve the domain.
![Pasted image 20240715103329.png](/images/Pasted image 20240715103329.png){: .normal width="400" }

On the main webpage we find the flask and searchor version of 2.4.0.
![Pasted image 20240715103325.png](/images/Pasted image 20240715103325.png){: .normal width="500" }


### Establish shell
We can establish a shell using the searchor 2.4.0 vulnerability.
![Pasted image 20240715103319.png](/images/Pasted image 20240715103319.png){: .normal }

Our nc listener should have turned into a shell now.
![Pasted image 20240715103315.png](/images/Pasted image 20240715103315.png){: .normal }


### File exploration
Looking through the files in the app folder we find a hidden .git folder that contains a config file. In this file we find credentials and a new subdomain: `cody:jh1usoih2bkjaspwe92`
![Pasted image 20240715103311.png](/images/Pasted image 20240715103311.png){: .normal }

Edit the hosts file and add the newly found subdomain: `gitea.searcher.htb`.
![Pasted image 20240715103307.png](/images/Pasted image 20240715103307.png){: .normal width="500" }



## _**Priv Esc**_
The Cody user doesn't exist in `/etc/passwd`. Instead, we can use the password to run sudo -l as the svc user.
![Pasted image 20240715103304.png](/images/Pasted image 20240715103304.png){: .normal }

Running the command to trigger a help menu.
![Pasted image 20240715103259.png](/images/Pasted image 20240715103259.png){: .normal width="600" }

The full-checkup script only seems to work when we are in the `/opt/scripts` directory.
![Pasted image 20240715103255.png](/images/Pasted image 20240715103255.png){: .normal }

Since we can run this script as sudo we can make a full-checkup file with a reverse shell payload which will be executed as root.
![Pasted image 20240715103251.png](/images/Pasted image 20240715103251.png){: .normal }

We obtained a shell as the root user.
![Pasted image 20240715103246.png](/images/Pasted image 20240715103246.png){: .normal width="600" }


## User.txt
![Pasted image 20240715103242.png](/images/Pasted image 20240715103242.png){: .normal width="400" }


## Root.txt
![Pasted image 20240715103237.png](/images/Pasted image 20240715103237.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715103231.png](/images/Pasted image 20240715103231.png){: .normal }


### Sources
- [Searchor 2.4.0 exploit](https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection)
- [Reverse shell](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#bash-tcp)