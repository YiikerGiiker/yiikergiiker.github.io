---
layout: post
title: "HTB Windows Easy: Optimum"
description: "Optimum is an Easy rated Windows machine on HTB."
categories: [CTF,HTB]
tags: [Windows,Easy]
author: g
---

## Nmap
![Pasted image 20240714201249.png](/images/Pasted image 20240714201249.png){: .normal }

## _**Initial Foothold**_
### Enumerating HTTP (Port 80)
Web service is running a vulnerable version of HttpFileServer.
![Pasted image 20240714201239.png](/images/Pasted image 20240714201239.png){: .normal }


### Exploit vulnerability
Searchsploit.
![Pasted image 20240714201233.png](/images/Pasted image 20240714201233.png){: .normal }


Make a PowerShell reverse shell script file that we will invoke using a command injection vulnerability, also start a Python webserver to make sure the file is reachable.
![Pasted image 20240714201229.png](/images/Pasted image 20240714201229.png){: .normal }


Now set up a nc listener and execute the script.
![Pasted image 20240714201219.png](/images/Pasted image 20240714201219.png){: .normal }


You should now have a shell as the kostas user:
![Pasted image 20240714201215.png](/images/Pasted image 20240714201215.png){: .normal width="500" }



## _**Priv Esc**_
OS info:
![Pasted image 20240714201211.png](/images/Pasted image 20240714201211.png){: .normal }


Looking for an exploit using searchsploit we find a PowerShell script that should escalate our privileges.
![Pasted image 20240714201206.png](/images/Pasted image 20240714201206.png){: .normal }


Since for some reason I couldn't get the script to work. I decided to go the Metasploit route, first we need a regular session within Metasploit:
![Pasted image 20240714201202.png](/images/Pasted image 20240714201202.png){: .normal }


Now we can background this session and use it to escalate our privileges using MS16-032.
![Pasted image 20240714201152.png](/images/Pasted image 20240714201152.png){: .normal }


We now have a privileged shell as the SYSTEM user.
![Pasted image 20240714201147.png](/images/Pasted image 20240714201147.png){: .normal width="600" }



## User.txt
![Pasted image 20240714201138.png](/images/Pasted image 20240714201138.png){: .normal width="400" }


## Root.txt
![Pasted image 20240714201132.png](/images/Pasted image 20240714201132.png){: .normal width="600" }


## You have PWNED!!!
![Pasted image 20240714201128.png](/images/Pasted image 20240714201128.png){: .normal }



### Sources
- [Powershell RevShell oneliner](https://gist.github.com/egre55/c058744a4240af6515eb32b2d33fbed3)
- [HttpFileServer exploit](https://www.exploit-db.com/exploits/49125)
- [Get OS info](https://www.faqforge.com/powershell/get-operating-system-details-powershell/)
- [MS16-032 metasploit](https://www.rapid7.com/db/modules/exploit/windows/local/ms16_032_secondary_logon_handle_privesc/)