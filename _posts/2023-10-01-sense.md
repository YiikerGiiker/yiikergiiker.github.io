---
layout: post
title: "HTB Linux Easy: Sense"
description: "Sense is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715104233.png](/images/Pasted image 20240715104233.png){: .normal }

## _**Initial Foothold**_
### Enumerating versions
Lighttpd 1.4.35 release date: `12/03/2014`.
![Pasted image 20240715104223.png](/images/Pasted image 20240715104223.png){: .normal }

No vulnerabilities were identified using searchsploit.
![Pasted image 20240715104219.png](/images/Pasted image 20240715104219.png){: .normal width="450"}

Pfsense, possibly also not updated since `12/03/2014`, likely running version 2.1.
![Pasted image 20240715104214.png](/images/Pasted image 20240715104214.png){: .normal width="600" }

Vulnerabilities.
![Pasted image 20240715104210.png](/images/Pasted image 20240715104210.png){: .normal }

### Enumerating HTTPS (port 443)
We seem to be dealing with an outdated version of pfSense judging from the login page.
![Pasted image 20240715104206.png](/images/Pasted image 20240715104206.png){: .normal width="400" }

Running gobuster for directory busting.
![Pasted image 20240715104202.png](/images/Pasted image 20240715104202.png){: .normal }

Content of the `system-users.txt` file.
![Pasted image 20240715104157.png](/images/Pasted image 20240715104157.png){: .normal }

The default password for pfsense is `pfsense`, we can use this to log in.
![Pasted image 20240715104152.png](/images/Pasted image 20240715104152.png){: .normal width="500" }

Log into pfSense using the following credentials: `rohit:pfsense`.
![Pasted image 20240715104146.png](/images/Pasted image 20240715104146.png){: .normal width="400" }


## Gain shell
Once logged in we can find a copyright for 2004-2014. This means that we can try the exploit we found earlier.
![Pasted image 20240715104142.png](/images/Pasted image 20240715104142.png){: .normal }

Add the following parameters to the script.
![Pasted image 20240715104135.png](/images/Pasted image 20240715104135.png){: .normal width="500" }

Run the exploit.
![Pasted image 20240715104129.png](/images/Pasted image 20240715104129.png){: .normal }

Your nc listener should have turned into a shell.
![Pasted image 20240715104122.png](/images/Pasted image 20240715104122.png){: .normal width="500" }


## User.txt
![Pasted image 20240715104118.png](/images/Pasted image 20240715104118.png){: .normal width="400" }


## Root.txt
![Pasted image 20240715104113.png](/images/Pasted image 20240715104113.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715104108.png](/images/Pasted image 20240715104108.png){: .normal }


### Sources
- [pfSense release dates](https://docs.netgate.com/pfsense/en/latest/releases/versions.html)
- [Default credentials](https://docs.netgate.com/pfsense/en/latest/usermanager/defaults.html)
- [pfSense CVE](https://www.exploit-db.com/exploits/43560)