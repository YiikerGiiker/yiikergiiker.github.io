---
layout: post
title: "Keeper"
description: "Keeper is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

### Nmap scan
![Pasted image 20240715100207.png](/images/Pasted image 20240715100207.png){: .normal }

## _**Initial Foothold**_

### Enumerate HTTP (Port 80)
Visit the website to find a URL:
![Pasted image 20240715100213.png](/images/Pasted image 20240715100213.png){: .normal width="600" }


Add `tickets.keeper.htb` and `keeper.htb` to /etc/hosts:
![Pasted image 20240715100220.png](/images/Pasted image 20240715100220.png){: .normal width="500" }


Test for default credentials, found: `root:password`.
![Pasted image 20240715100154.png](/images/Pasted image 20240715100154.png){: .normal width="500" }


Found Admin users (Lise Norgaard), could be interesting in the future?
![Pasted image 20240715100146.png](/images/Pasted image 20240715100146.png){: .normal }


An open ticket points to issues with KeePass which can be used in the future.
![Pasted image 20240715100127.png](/images/Pasted image 20240715100127.png){: .normal width="500" }

Clicking on the lnorgaard user in the admin page reveals a password:
![Pasted image 20240715100132.png](/images/Pasted image 20240715100132.png){: .normal width="600" }

Use credentials to log into the box: `lnorgaard:Welcome2023!`.
![Pasted image 20240715100137.png](/images/Pasted image 20240715100137.png){: .normal }



## _**Privilege Escalation**_
Retrieve the files found in the home folder of lnorgaard:
![Pasted image 20240715100107.png](/images/Pasted image 20240715100107.png){: .normal }
![Pasted image 20240715100102.png](/images/Pasted image 20240715100102.png){: .normal }

We can use a Python script against the KeePass file to possibly retrieve passwords.
![Pasted image 20240715100057.png](/images/Pasted image 20240715100057.png){: .normal width="500" }


Some OSINT later:
![Pasted image 20240715100051.png](/images/Pasted image 20240715100051.png){: .normal }
![Pasted image 20240715100045.png](/images/Pasted image 20240715100045.png){: .normal width="300" }

Found the name of a danish dessert `rødgrød med fløde`, this is the master password of the KeePass file.

Open the KeePass file: `root:F4><3K0nd!`
![Pasted image 20240715100039.png](/images/Pasted image 20240715100039.png){: .normal }

Root password doesn't work. However we have a putty user key file in the notes. Use this to establish a root shell.
![Pasted image 20240715100035.png](/images/Pasted image 20240715100035.png){: .normal }

Set the IP address and port of the machine in PuTTY.
![Pasted image 20240715100031.png](/images/Pasted image 20240715100031.png){: .normal width="500" }

Assign ppk file, SSH, auth, browse and select the putty.ppk file.
![Pasted image 20240715100026.png](/images/Pasted image 20240715100026.png){: .normal width="500" }

Log in as the root user.
![Pasted image 20240715100020.png](/images/Pasted image 20240715100020.png){: .normal }

## User.txt
![Pasted image 20240715100015.png](/images/Pasted image 20240715100015.png){: .normal width="400" }

## Root.txt
![Pasted image 20240715100009.png](/images/Pasted image 20240715100009.png){: .normal width="400" }

## Pwned!!!
![Pasted image 20240715100003.png](/images/Pasted image 20240715100003.png){: .normal }

### Sources:
- [Default Credentials](https://forum.bestpractical.com/t/forgot-admin-password-of-rt/33451)
- [Python Script KeePass](https://github.com/CMEPW/keepass-dump-masterkey/tree/main)
- [OSINT](https://nordicfoodliving.com/danish-red-berry-pudding-rodgrod-med-flode/)