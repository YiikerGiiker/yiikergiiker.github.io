---
layout: post
title: "Cap"
description: "Cap is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

### Nmap scan
![Pasted image 20240715102246.png](/images/Pasted image 20240715102246.png){: .normal }


## _**Initial Foothold**_
Visiting the webpage we find a tab that allows us to download Wireshark captures, the data number in the URL can be changed to get Wireshark captures for other users (IDOR).
![Pasted image 20240715102240.png](/images/Pasted image 20240715102240.png){: .normal }


Only `0` gives us a different result. We can download this capture using the download button and open it in Wireshark, looking through the data we find a username and password in plain text format: `nathan:Buck3tH4TF0RM3!`
![Pasted image 20240715102235.png](/images/Pasted image 20240715102235.png){: .normal }


Even though the credentials were used to login to FTP, we will try to log in to SSH using the same credentials.
![Pasted image 20240715102230.png](/images/Pasted image 20240715102230.png){: .normal width="500" }


## _**Priv Esc**_
Linpeas reveals a priv esc using Python capabilities.
![Pasted image 20240715102221.png](/images/Pasted image 20240715102221.png){: .normal }


Become root:
![Pasted image 20240715102225.png](/images/Pasted image 20240715102225.png){: .normal }


## User.txt
![Pasted image 20240715102216.png](/images/Pasted image 20240715102216.png){: .normal width="400" }


## Root.txt
![Pasted image 20240715102211.png](/images/Pasted image 20240715102211.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715102205.png](/images/Pasted image 20240715102205.png){: .normal }


### Sources
- [Python Priv-Esc](https://gtfobins.github.io/gtfobins/python/#capabilities)