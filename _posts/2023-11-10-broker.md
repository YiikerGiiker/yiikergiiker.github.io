---
layout: post
title: "Broker"
description: "Broker is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715102424.png](/images/Pasted image 20240715102424.png){: .normal }
![Pasted image 20240715102420.png](/images/Pasted image 20240715102420.png){: .normal }
![Pasted image 20240715102415.png](/images/Pasted image 20240715102415.png){: .normal }
![Pasted image 20240715102411.png](/images/Pasted image 20240715102411.png){: .normal }

## _**Initial Foothold**_

### Enumerate HTTP (Port 61616)
ActiveMQ is running on port 61616. The version is 5.15.15, as disclosed by Nmap. We can use a Python PoC to gain shell access to the machine (modify poc.xml)
![Pasted image 20240715102402.png](/images/Pasted image 20240715102402.png){: .normal }



## _**Priv Esc**_
Sudo -l output.
![Pasted image 20240715102357.png](/images/Pasted image 20240715102357.png){: .normal }

The Zimbra Nginx local root exploit PoC script can be used to escalate to root:
![Pasted image 20240715102352.png](/images/Pasted image 20240715102352.png){: .normal width="500" }

## User.txt
![Pasted image 20240715102347.png](/images/Pasted image 20240715102347.png){: .normal width="500" }

## Root.txt
![Pasted image 20240715102342.png](/images/Pasted image 20240715102342.png){: .normal width="650" }


## You have PWNED
![Pasted image 20240715102338.png](/images/Pasted image 20240715102338.png){: .normal }


### Sources
- [Activemq PoC](https://github.com/evkl1d/CVE-2023-46604)
- [Priv-Esc](https://darrenmartynie.wordpress.com/2021/10/25/zimbra-nginx-local-root-exploit/)