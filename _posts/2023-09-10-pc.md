---
layout: post
title: "HTB Linux Easy: PC"
description: "PC is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
![Pasted image 20240715111019.png](/images/Pasted image 20240715111019.png){: .normal }


## Initial foothold
Googling for services that use port 50051 we get gRPC, to interact with a gRPC instance we can use grpcui.
![Pasted image 20240715111015.png](/images/Pasted image 20240715111015.png){: .normal width="500" }

We get the following page when we browse to the URL.
![Pasted image 20240715111011.png](/images/Pasted image 20240715111011.png){: .normal width="500" }

We are able to register an account on this page.
![Pasted image 20240715111007.png](/images/Pasted image 20240715111007.png){: .normal width="500" }
![Pasted image 20240715111003.png](/images/Pasted image 20240715111003.png){: .normal width="500" }

We can log in to the application using our registered account.
![Pasted image 20240715110957.png](/images/Pasted image 20240715110957.png){: .normal }

We need to supply our token for the getinfo method to work, the id parameter also looks vulnerable to SQLi.
![Pasted image 20240715110952.png](/images/Pasted image 20240715110952.png){: .normal }

Go into Burp and save the request.
![Pasted image 20240715110947.png](/images/Pasted image 20240715110947.png){: .normal }

Supply the request to sqlmap and set the payload to the id parameter: `sau:HereIsYourPassWord1431`.
![Pasted image 20240715110943.png](/images/Pasted image 20240715110943.png){: .normal }
![Pasted image 20240715110940.png](/images/Pasted image 20240715110940.png){: .normal }

Lastly we can SSH into the machine as the sau user.
![Pasted image 20240715110936.png](/images/Pasted image 20240715110936.png){: .normal width="500" }


## Priv Esc
Nothing in particular stood out after running Linpeas except for a service on port 8000 that could only be accessed from the localhost.
![Pasted image 20240715110932.png](/images/Pasted image 20240715110932.png){: .normal }

Curling the webpage with redirect enabled we see that the page uses pyload.
![Pasted image 20240715110926.png](/images/Pasted image 20240715110926.png){: .normal }

Since we already have shell access to the system we can verify what version of pyload is running.
![Pasted image 20240715110919.png](/images/Pasted image 20240715110919.png){: .normal width="300" }

In this case RCE, let's create a rev shell script on the target system that we will execute using the RCE vuln.
![Pasted image 20240715110915.png](/images/Pasted image 20240715110915.png){: .normal width="600" }

Before executing our payload we will set a nc listener to catch our reverse shell.
![Pasted image 20240715110905.png](/images/Pasted image 20240715110905.png){: .normal width="300" }

Let's get a shell now.
![Pasted image 20240715110859.png](/images/Pasted image 20240715110859.png){: .normal }
![Pasted image 20240715110855.png](/images/Pasted image 20240715110855.png){: .normal }


## User.txt
![Pasted image 20240715110851.png](/images/Pasted image 20240715110851.png){: .normal width="400" }

## Root.txt
![Pasted image 20240715110846.png](/images/Pasted image 20240715110846.png){: .normal width="400" }

## Pwned
![Pasted image 20240715110842.png](/images/Pasted image 20240715110842.png){: .normal }


### Sources
- [grpcui](https://github.com/fullstorydev/grpcui)
- [pyload](https://github.com/bAuh0lz/CVE-2023-0297_Pre-auth_RCE_in_pyLoad)