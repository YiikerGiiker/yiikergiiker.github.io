---
layout: post
title: "HTB Linux Easy: Knife"
description: "Knife is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

### Nmap scan
![Pasted image 20240715102620.png](/images/Pasted image 20240715102620.png){: .normal }

## _**Initial Foothold**_

### Enumerate HTTP (Port 80)
Nothing interesting found while dirbusting, enumerating the page, etc. We do know that PHP is running on the server, we can determine the version using curl.
![Pasted image 20240715102616.png](/images/Pasted image 20240715102616.png){: .normal width="500" }

### Gain shell
Run the Python exploit (it will use the host User-Agent header to execute a reverse shell).
![Pasted image 20240715102611.png](/images/Pasted image 20240715102611.png){: .normal }

Our nc listener will have turned into a shell.
![Pasted image 20240715102605.png](/images/Pasted image 20240715102605.png){: .normal }



## _**Priv Esc**_
Sudo -l reveals a program that we can execute as root.
![Pasted image 20240715102600.png](/images/Pasted image 20240715102600.png){: .normal }

Following the command on GTFOBins results in a root shell.
![Pasted image 20240715102556.png](/images/Pasted image 20240715102556.png){: .normal width="550" }


## User.txt
![Pasted image 20240715102550.png](/images/Pasted image 20240715102550.png){: .normal width="400" }


## Root.txt
![Pasted image 20240715102545.png](/images/Pasted image 20240715102545.png){: .normal width="400" }


## You have PWNED
![Pasted image 20240715102521.png](/images/Pasted image 20240715102521.png){: .normal }


### Sources
- [Find PHP version](https://stackoverflow.com/questions/4672088/how-can-i-find-the-version-of-php-that-is-running-on-a-distinct-domain-name)
- [PHP exploit](https://github.com/flast101/php-8.1.0-dev-backdoor-rce)
- [Knife Priv-Esc](https://gtfobins.github.io/gtfobins/knife/#sudo)