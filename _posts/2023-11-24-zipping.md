---
layout: post
title: "HTB Linux Medium: Zipping"
description: "Zipping is a Medium rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Medium]
author: g
---

## Nmap
![Pasted image 20240714205321.png](/images/Pasted image 20240714205321.png){: .normal }


## _**Initial Foothold**_
## Enumerate HTTP (Port 80)
Using Dirsearch to reveal subdirectories and files reveals the upload.php page.
![Pasted image 20240714205312.png](/images/Pasted image 20240714205312.png){: .normal width="550"}


On the upload page we can upload ZIP files.
![Pasted image 20240714205305.png](/images/Pasted image 20240714205305.png){: .normal }


Bypassing the upload filter can be done using symlinks, generate the following ZIP file.
![Pasted image 20240714205256.png](/images/Pasted image 20240714205256.png){: .normal width="500"}


Next up we can upload the zip file and visit the document.pdf file. Once there we can go to our network tab and the response should be a base64 encoded string that we can decode.
![Pasted image 20240714205252.png](/images/Pasted image 20240714205252.png){: .normal }


Whilst enumerating files we find a grep_match vulnerability in cart.php which can be exploited in the following way.
![Pasted image 20240714205248.png](/images/Pasted image 20240714205248.png){: .normal }


## _**Priv Esc**_
Running sudo -l results in the following output.
![Pasted image 20240714205241.png](/images/Pasted image 20240714205241.png){: .normal }


Running the strings command against the file reveals a hardcoded password: `St0ckM4nager`.
![Pasted image 20240714205231.png](/images/Pasted image 20240714205231.png){: .normal width="350"}


Using strace we find that the program calls for a non existent libcounter.so file located in /home/rektsu/.config/. We can abuse this by creating a reverse shell payload with this filename inside of the `.config` directory.
![Pasted image 20240714205224.png](/images/Pasted image 20240714205224.png){: .normal }


Next, we use gcc to create the .so file.
![Pasted image 20240714205218.png](/images/Pasted image 20240714205218.png){: .normal }


Now when we run the program and enter the password we should get a shell.
![Pasted image 20240714205213.png](/images/Pasted image 20240714205213.png){: .normal width="500" }


You should now catch a root shell.
![Pasted image 20240714205207.png](/images/Pasted image 20240714205207.png){: .normal width="600" }


## User.txt
![Pasted image 20240714205152.png](/images/Pasted image 20240714205152.png){: .normal width="400"}


## Root.txt
![Pasted image 20240714205148.png](/images/Pasted image 20240714205148.png){: .normal width="400"}


## PWNED!!!
![Pasted image 20240714205143.png](/images/Pasted image 20240714205143.png){: .normal }