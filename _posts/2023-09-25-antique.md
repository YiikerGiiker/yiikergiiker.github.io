---
layout: post
title: "Antique"
description: "Antique is an Easy rated Linux machine on HTB."
categories: [CTF,HTB]
tags: [Linux,Easy]
author: g
---

## Nmap
TCP
![Pasted image 20240715103121.png](/images/Pasted image 20240715103121.png){: .normal }


UDP
![Pasted image 20240715103117.png](/images/Pasted image 20240715103117.png){: .normal }

## _**Initial Foothold**_

### Enumerating SNMP (port 161)
As a result of the password disclosure vulnerability, the extracted hex string decodes to the plaintext password **P@ssw0rd@123!!123**.
![Pasted image 20240715103113.png](/images/Pasted image 20240715103113.png){: .normal }



### Enumerating telnet (port 23)
Following the SNMP information disclosure, we were able to use the password to authenticate to the Telnet service.
![Pasted image 20240715103103.png](/images/Pasted image 20240715103103.png){: .normal width="350"}


Looks like we are able to execute system commands.
![Pasted image 20240715103058.png](/images/Pasted image 20240715103058.png){: .normal }


Execute a reverse shell using the following payload:
![Pasted image 20240715103053.png](/images/Pasted image 20240715103053.png){: .normal }


Shell as the lp user:
![Pasted image 20240715103049.png](/images/Pasted image 20240715103049.png){: .normal }



## _**Priv Esc**_
Linpeas discovers a service that is running on port 631 that can only be accessed from the localhost.
![Pasted image 20240715103045.png](/images/Pasted image 20240715103045.png){: .normal }


By curling the page, we identified a CUPS server running version 1.6.1, which is vulnerable and may allow access to root-owned files.
![Pasted image 20240715103040.png](/images/Pasted image 20240715103040.png){: .normal }

The flag can be obtained without needing to become root


## User.txt
![Pasted image 20240715103034.png](/images/Pasted image 20240715103034.png){: .normal width="350" }


## Root.txt
![Pasted image 20240715103025.png](/images/Pasted image 20240715103025.png){: .normal width="580" }


## You have PWNED
![Pasted image 20240715103015.png](/images/Pasted image 20240715103015.png){: .normal }



### Sources
- [Password leak vuln](https://www.exploit-db.com/exploits/22319)
- [CUPS vuln](https://github.com/p1ckzi/CVE-2012-5519)